var q=(l,o,s)=>new Promise((e,c)=>{var f=p=>{try{g(s.next(p))}catch(_){c(_)}},u=p=>{try{g(s.throw(p))}catch(_){c(_)}},g=p=>p.done?e(p.value):Promise.resolve(p.value).then(f,u);g((s=s.apply(l,o)).next())});import{n as y,h as k,q as B,y as C,x as v,A as b,B as j,o as G,r as H,a as r,b as w,c as J,e as i,w as n,f as x,l as S,j as U}from"./0ae629d1.js";function Q(l){return y({url:"/admin/system.dict/listp",method:"get",params:l})}function X(l){return y({url:"/admin/system.dict/listz",method:"get",params:l})}function Y(l){return y({url:"/admin/system.dict/add",method:"post",data:l})}function Z(l){return y({url:"/admin/system.dict/edit",method:"put",data:l})}function ee(l){return y({url:"/admin/system.dict/del",method:"delete",params:l})}const ie={__name:"sysDict",setup(l){const o=k({data:[],option:{},check:0}),s=k({page:1,pageSize:10,total:0}),e=k({title:"添加字典",visible:!1,form:{name:"",value:"",sort:100,description:""},rules:{name:[{required:!0,message:"请输入字典名称！",trigger:["input","blur"]}],value:[{required:!0,message:"请输入字典值！",trigger:["input","blur"]}]}}),c=k({data:[],loading:!1,columns:[{type:"selection",fixed:"left"},{title:"字典名称",key:"name",width:150},{title:"字典值",key:"value",maxWidth:80},{title:"描述",key:"description",width:150},{title:"操作",key:"actions",width:200,fixed:"right",render(a){const t=B("permission");return C(j,{},{default:()=>[v(C(b,{text:!0,size:"small",type:"primary",onClick:()=>L(a)},{default:()=>"编辑"}),[[t,{action:"dictv:edit"}]]),v(C(b,{text:!0,size:"small",type:"primary",onClick:()=>O(a)},{default:()=>"删除"}),[[t,{action:"dictv:delete"}]])]})}}]});G(()=>{f()});const f=()=>{Q().then(a=>{o.data=a.data.list,a.data.list.length&&u(a.data.list[0].id)})},u=a=>{c.loading=!0;const t={pid:a,page:s.page,pageSize:s.pageSize};X(t).then(d=>{c.data=d.data.list.data,s.total=d.data.list.total,c.loading=!1})},g=()=>{e.visible=!0,e.title="添加字典",e.form={pid:0,name:"",value:"",sort:100,description:""}},p=()=>{e.title="编辑字典",e.visible=!0,e.form=Object.assign({},o.option)},_=()=>{o.option.id?O(o.option):$message.success("没有选择数据！")},A=a=>{ee({id:a.id}).then(t=>{$message.success(t.message),f()})},O=a=>{$dialog.confirm({title:"删除警告",content:"你确定要删除此字典吗？",confirm(){A(a)},cancel(){$message.success("取消删除！")}})},N=(a,t)=>{o.option=t[0],u(t[0].id)},P=H(null),E=()=>{var a;(a=P.value)==null||a.validate(t=>q(this,null,function*(){if(t)console.log(t);else{console.log("suc");const d=e.form.id?yield Z(e.form):yield Y(e.form);d.code===200&&(e.visible=!1,f()),$message.success(d.message)}}))},F=()=>{o.option.id?(e.visible=!0,e.title="添加字典项",e.form={pid:o.option.id,name:"",value:"",sort:100,description:""}):$message.warning("选择左侧字典！")},K=a=>{var d;s.page=a.page,s.pageSize=a.pageSize;const t=(d=o.option)!=null&&d.id?o.option.id:o.data[0].id;u(t)},L=a=>{e.title="编辑字典项",e.visible=!0,e.form=Object.assign({},a)};return(a,t)=>{const d=r("n-tree"),R=r("n-card"),$=r("n-gi"),V=r("page-table"),I=r("n-grid"),z=r("n-input"),h=r("n-form-item"),M=r("n-input-number"),T=r("n-form"),W=r("page-model"),D=B("permission");return w(),J("div",null,[i(I,{"x-gap":"12",cols:"1 s:1 m:1 l:6 xl:6 2xl:6",responsive:"screen"},{default:n(()=>[i($,{span:2},{default:n(()=>[i(R,{bordered:!1},{default:n(()=>[i(x(j),{class:"mb-5"},{default:n(()=>[v((w(),S(x(b),{size:"small",onClick:g},{default:n(()=>[U(" 新建 ")]),_:1})),[[D,{action:"dictp:add"}]]),v((w(),S(x(b),{size:"small",type:"primary",onClick:p},{default:n(()=>[U(" 编辑 ")]),_:1})),[[D,{action:"dictp:edit"}]]),v((w(),S(x(b),{size:"small",type:"error",onClick:_},{default:n(()=>[U(" 删除 ")]),_:1})),[[D,{action:"dictp:delete"}]])]),_:1}),i(d,{"block-line":"",data:o.data,"key-field":"id","label-field":"name",selectable:"","onUpdate:selectedKeys":N},null,8,["data"])]),_:1})]),_:1}),i($,{span:4},{default:n(()=>[i(R,{bordered:!1},{default:n(()=>[i(V,{data:c.data,columns:c.columns,loading:c.loading,onOnAdd:F,onOnRefresh:u,pagination:!0,pageProps:s,onOnUpdatePage:K,permission:{action:"dictv:add"}},null,8,["data","columns","loading","pageProps"])]),_:1})]),_:1})]),_:1}),i(W,{visible:e.visible,"onUpdate:visible":t[4]||(t[4]=m=>e.visible=m),title:e.title,onOnSave:E},{default:n(()=>[i(T,{ref_key:"formRefs",ref:P,"label-placement":"left","label-width":80,model:e.form,rules:e.rules,"show-require-mark":!0},{default:n(()=>[i(h,{label:"字典名称",path:"name"},{default:n(()=>[i(z,{value:e.form.name,"onUpdate:value":t[0]||(t[0]=m=>e.form.name=m),placeholder:"请输入字典名称..."},null,8,["value"])]),_:1}),i(h,{label:"字典值",path:"value"},{default:n(()=>[i(z,{value:e.form.value,"onUpdate:value":t[1]||(t[1]=m=>e.form.value=m),placeholder:"请输入字典值..."},null,8,["value"])]),_:1}),i(h,{label:"排序",path:"sort"},{default:n(()=>[i(M,{value:e.form.sort,"onUpdate:value":t[2]||(t[2]=m=>e.form.sort=m),placeholder:"请输入排序..."},null,8,["value"])]),_:1}),i(h,{label:"备注",path:"description"},{default:n(()=>[i(z,{value:e.form.description,"onUpdate:value":t[3]||(t[3]=m=>e.form.description=m),type:"textarea",placeholder:"---"},null,8,["value"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["visible","title"])])}}};export{ie as default};
//# sourceMappingURL=24994495.js.map
