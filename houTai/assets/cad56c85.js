var D=(U,g,m)=>new Promise((d,i)=>{var t=r=>{try{v(m.next(r))}catch(p){i(p)}},n=r=>{try{v(m.throw(r))}catch(p){i(p)}},v=r=>r.done?d(r.value):Promise.resolve(r.value).then(t,n);v((m=m.apply(U,g)).next())});import{a as W,b as H,_ as M,c as T,u as G,d as J}from"./a32981b8.js";import{r as K}from"./3cec01e0.js";import{h as y,r as h,y as _,I as Q,q as X,x as S,A as w,B as $,v as Y,o as Z,a as u,b as ee,c as ae,d as x,e as s,w as o,f as te,j as N}from"./0ae629d1.js";const se={class:"page-contanier"},le={ref:"pageHeader",class:"page-header"},oe={class:"page-content"},de={__name:"sysUser",setup(U){const g=y({value:""}),m=h([]),d=y({page:1,pageSize:10,total:0}),i=y({data:[],loading:!1,columns:[{type:"selection",fixed:"left"},{title:"用户名",key:"username"},{title:"昵称",key:"nick_name"},{title:"邮箱",key:"email"},{title:"备注",key:"notes"},{title:"状态",key:"status",render(a){return _(Q,{value:a.state,checkedValue:1,uncheckedValue:0,"on-update:value":e=>V(a,e)})}},{title:"创建日期",key:"create_time"},{title:"操作",key:"actions",width:200,fixed:"right",render(a){const e=X("permission");return _($,{},{default:()=>[S(_(w,{size:"small",onClick:()=>O(a)},{default:()=>"密码"}),[[e,{action:"user:password"}]]),S(_(w,{size:"small",type:"primary",onClick:()=>P(a)},{default:()=>"编辑"}),[[e,{action:"user:edit"}]]),S(_(w,{size:"small",type:"error",onClick:()=>C(a)},{default:()=>"删除"}),[[e,{action:"user:delete"}]])]})}}]}),t=y({title:"用户新增",visible:!1,form:{username:"",nick_name:"",email:"",state:1,notes:"",roles:4},rules:{username:[{required:!0,message:"请输入用户名！",trigger:["input","blur"]}],nickName:[{required:!0,message:"请输入用昵称！",trigger:["input","blur"]}],email:[{required:!0,message:"邮箱格式不正确！",trigger:["input","blur"],validator:(a,e)=>Y(e)}]}});Z(()=>{n(),v()});const n=()=>{i.loading=!0;const a={keyword:g.value,page:d.page,pageSize:d.pageSize};W(a).then(e=>{i.data=e.data.list.data,d.total=e.data.list.total,i.loading=!1})},v=()=>{K({page:1,pageSize:9999}).then(e=>{m.value=e.data.list.data})},r=a=>{d.page=a.page,d.pageSize=a.pageSize,n()},p=h(null),O=a=>{var e;(e=p.value)==null||e.passShow(a.id)},P=a=>{t.title="用户编辑",t.visible=!0,t.form=Object.assign({},a)},R=a=>{T({id:a.id}).then(e=>{$message.success(e.message),n()})},C=a=>{$dialog.confirm({title:"删除警告",content:"你确定要删除此用户吗？",confirm(){R(a)},cancel(){$message.success("取消删除！")}})},V=(a,e)=>{H({id:a.id,state:e}).then(c=>{$message.success(c.message),n()})},q=(a,e)=>{var c;(c=a.value)==null||c.validate(b=>{b?console.log(b):(console.log("suc"),e&&e())})},B=()=>{const a=h(null);q(a,E())},E=()=>D(this,null,function*(){const a=t.form.id?yield G(t.form):yield J(t.form);a.code===200&&(t.visible=!1,n()),$message.success(a.message)}),A=()=>{t.title="用户新增",t.visible=!0,t.form={username:"",nick_name:"",email:"",state:1,notes:"",roles:4}};return(a,e)=>{const c=u("page-search"),b=u("page-table"),k=u("n-input"),f=u("n-form-item"),z=u("n-radio"),j=u("n-radio-group"),F=u("n-select"),I=u("n-form"),L=u("page-model");return ee(),ae("div",se,[x("div",le,[s(c,{value:g.value,"onUpdate:value":e[0]||(e[0]=l=>g.value=l),onOnSearch:e[1]||(e[1]=l=>n()),onOnReset:e[2]||(e[2]=l=>n())},null,8,["value"])],512),x("div",oe,[s(b,{data:i.data,columns:i.columns,loading:i.loading,permission:{action:"user:add"},onOnAdd:A,onOnRefresh:e[3]||(e[3]=l=>n()),pagination:!0,pageProps:d,onOnUpdatePage:r},null,8,["data","columns","loading","pageProps"])]),s(L,{visible:t.visible,"onUpdate:visible":e[10]||(e[10]=l=>t.visible=l),title:t.title,onOnSave:B},{default:o(()=>[s(I,{ref:"formRefs","label-placement":"left","label-width":80,model:t.form,rules:t.rules,"show-require-mark":!0},{default:o(()=>[s(f,{label:"用户名",path:"username"},{default:o(()=>[s(k,{value:t.form.username,"onUpdate:value":e[4]||(e[4]=l=>t.form.username=l),placeholder:"请输入用户名..."},null,8,["value"])]),_:1}),s(f,{label:"昵称",path:"nick_name"},{default:o(()=>[s(k,{value:t.form.nick_name,"onUpdate:value":e[5]||(e[5]=l=>t.form.nick_name=l),placeholder:"请输入昵称..."},null,8,["value"])]),_:1}),s(f,{label:"邮箱",path:"email"},{default:o(()=>[s(k,{value:t.form.email,"onUpdate:value":e[6]||(e[6]=l=>t.form.email=l),placeholder:"请输入邮箱..."},null,8,["value"])]),_:1}),s(f,{label:"状态",path:"state"},{default:o(()=>[s(j,{value:t.form.state,"onUpdate:value":e[7]||(e[7]=l=>t.form.state=l),name:"userstate"},{default:o(()=>[s(te($),null,{default:o(()=>[s(z,{value:1},{default:o(()=>[N(" 启用 ")]),_:1}),s(z,{value:0},{default:o(()=>[N(" 禁用 ")]),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),s(f,{label:"选择角色",path:"roles"},{default:o(()=>[s(F,{value:t.form.roles,"onUpdate:value":e[8]||(e[8]=l=>t.form.roles=l),options:m.value,"label-field":"name","value-field":"id"},null,8,["value","options"])]),_:1}),s(f,{label:"备注",path:"notes"},{default:o(()=>[s(k,{value:t.form.notes,"onUpdate:value":e[9]||(e[9]=l=>t.form.notes=l),type:"textarea",placeholder:"---"},null,8,["value"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["visible","title"]),s(M,{ref_key:"passWord",ref:p},null,512)])}}};export{de as default};
//# sourceMappingURL=cad56c85.js.map
