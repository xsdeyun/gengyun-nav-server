{"version":3,"file":"24994495.js","sources":["../../src/api/system/dict.js","../../src/views/system/sysDict.vue"],"sourcesContent":["import { request } from '@/utils'\r\n\r\n\r\nexport function dListp(params) {\r\n    return request({\r\n        url: '/admin/system.dict/listp',\r\n        method: 'get',\r\n        params: params\r\n    })\r\n}\r\nexport function dListz(params) {\r\n    return request({\r\n        url: '/admin/system.dict/listz',\r\n        method: 'get',\r\n        params: params\r\n    })\r\n}\r\nexport function dAdd(data) {\r\n    return request({\r\n        url: '/admin/system.dict/add',\r\n        method: 'post',\r\n        data: data\r\n    })\r\n}\r\nexport function dEdit(data) {\r\n    return request({\r\n        url: '/admin/system.dict/edit',\r\n        method: 'put',\r\n        data: data\r\n    })\r\n}\r\nexport function dDelete(params) {\r\n    return request({\r\n        url: '/admin/system.dict/del',\r\n        method: 'delete',\r\n        params: params\r\n    })\r\n}","<template>\r\n  <div>\r\n    <n-grid x-gap=\"12\" cols=\"1 s:1 m:1 l:6 xl:6 2xl:6\" responsive=\"screen\">\r\n      <n-gi :span=\"2\">\r\n        <n-card :bordered=\"false\">\r\n          <n-space class=\"mb-5\">\r\n            <n-button\r\n              size=\"small\"\r\n              v-permission=\"{ action: 'dictp:add' }\"\r\n              @click=\"handleAddDictp\"\r\n            >\r\n              新建\r\n            </n-button>\r\n            <n-button\r\n              size=\"small\"\r\n              v-permission=\"{ action: 'dictp:edit' }\"\r\n              type=\"primary\"\r\n              @click=\"editDictpRow\"\r\n            >\r\n              编辑\r\n            </n-button>\r\n            <n-button\r\n              size=\"small\"\r\n              v-permission=\"{ action: 'dictp:delete' }\"\r\n              type=\"error\"\r\n              @click=\"deleteDictpRow\"\r\n            >\r\n              删除\r\n            </n-button>\r\n          </n-space>\r\n          <n-tree\r\n            block-line\r\n            :data=\"treeObj.data\"\r\n            key-field=\"id\"\r\n            label-field=\"name\"\r\n            selectable\r\n            @update:selected-keys=\"getSelectedKeys\"\r\n          />\r\n        </n-card>\r\n      </n-gi>\r\n      <n-gi :span=\"4\">\r\n        <n-card :bordered=\"false\">\r\n          <!-- table strat -->\r\n          <page-table\r\n            :data=\"table.data\"\r\n            :columns=\"table.columns\"\r\n            :loading=\"table.loading\"\r\n            @on-add=\"addFormData\"\r\n            @on-refresh=\"getDictPageData\"\r\n            :pagination=\"true\"\r\n            :pageProps=\"pageProps\"\r\n            @on-updatePage=\"UpdatePageChange\"\r\n            :permission=\"{ action: 'dictv:add' }\"\r\n          >\r\n          </page-table>\r\n          <!-- table end -->\r\n        </n-card>\r\n      </n-gi>\r\n    </n-grid>\r\n    <!-- model strat -->\r\n    <page-model\r\n      v-model:visible=\"modal.visible\"\r\n      :title=\"modal.title\"\r\n      @on-save=\"saveFormData\"\r\n    >\r\n      <n-form\r\n        ref=\"formRefs\"\r\n        label-placement=\"left\"\r\n        :label-width=\"80\"\r\n        :model=\"modal.form\"\r\n        :rules=\"modal.rules\"\r\n        :show-require-mark=\"true\"\r\n      >\r\n        <n-form-item label=\"字典名称\" path=\"name\">\r\n          <n-input\r\n            v-model:value=\"modal.form.name\"\r\n            placeholder=\"请输入字典名称...\"\r\n          />\r\n        </n-form-item>\r\n        <n-form-item label=\"字典值\" path=\"value\">\r\n          <n-input\r\n            v-model:value=\"modal.form.value\"\r\n            placeholder=\"请输入字典值...\"\r\n          />\r\n        </n-form-item>\r\n        <n-form-item label=\"排序\" path=\"sort\">\r\n          <n-input-number\r\n            v-model:value=\"modal.form.sort\"\r\n            placeholder=\"请输入排序...\"\r\n          />\r\n        </n-form-item>\r\n        <n-form-item label=\"备注\" path=\"description\">\r\n          <n-input\r\n            v-model:value=\"modal.form.description\"\r\n            type=\"textarea\"\r\n            placeholder=\"---\"\r\n          />\r\n        </n-form-item>\r\n      </n-form>\r\n    </page-model>\r\n    <!-- model end -->\r\n  </div>\r\n</template>\r\n<script setup>\r\nimport { dListp, dListz, dAdd, dEdit, dDelete } from \"@/api/system/dict.js\";\r\nimport {\r\n  onMounted,\r\n  h,\r\n  ref,\r\n  reactive,\r\n  withDirectives,\r\n  resolveDirective,\r\n} from \"vue\";\r\nimport { NSpace, NButton } from \"naive-ui\";\r\n\r\nconst treeObj = reactive({\r\n  data: [],\r\n  option: {},\r\n  check: 0,\r\n});\r\n// page\r\nconst pageProps = reactive({\r\n  page: 1,\r\n  pageSize: 10,\r\n  total: 0,\r\n});\r\n// 弹窗数据\r\nconst modal = reactive({\r\n  title: \"添加字典\",\r\n  visible: false,\r\n  form: {\r\n    name: \"\",\r\n    value: \"\",\r\n    sort: 100,\r\n    description: \"\",\r\n  },\r\n  rules: {\r\n    name: [\r\n      {\r\n        required: true,\r\n        message: \"请输入字典名称！\",\r\n        trigger: [\"input\", \"blur\"],\r\n      },\r\n    ],\r\n    value: [\r\n      { required: true, message: \"请输入字典值！\", trigger: [\"input\", \"blur\"] },\r\n    ],\r\n  },\r\n});\r\n// table data\r\nconst table = reactive({\r\n  data: [],\r\n  loading: false,\r\n  columns: [\r\n    {\r\n      type: \"selection\",\r\n      fixed: \"left\",\r\n    },\r\n    {\r\n      title: \"字典名称\",\r\n      key: \"name\",\r\n      width: 150,\r\n    },\r\n    {\r\n      title: \"字典值\",\r\n      key: \"value\",\r\n      maxWidth: 80,\r\n    },\r\n    {\r\n      title: \"描述\",\r\n      key: \"description\",\r\n      width: 150,\r\n    },\r\n    {\r\n      title: \"操作\",\r\n      key: \"actions\",\r\n      width: 200,\r\n      fixed: \"right\",\r\n      render(row) {\r\n        const permission = resolveDirective(\"permission\");\r\n        return h(\r\n          NSpace,\r\n          {},\r\n          {\r\n            default: () => [\r\n              withDirectives(\r\n                h(\r\n                  NButton,\r\n                  {\r\n                    text: true,\r\n                    size: \"small\",\r\n                    type: \"primary\",\r\n                    onClick: () => editRow(row),\r\n                  },\r\n                  { default: () => \"编辑\" }\r\n                ),\r\n                [[permission, { action: \"dictv:edit\" }]]\r\n              ),\r\n              withDirectives(\r\n                h(\r\n                  NButton,\r\n                  {\r\n                    text: true,\r\n                    size: \"small\",\r\n                    type: \"primary\",\r\n                    onClick: () => deleteRow(row),\r\n                  },\r\n                  { default: () => \"删除\" }\r\n                ),\r\n                [[permission, { action: \"dictv:delete\" }]]\r\n              ),\r\n            ],\r\n          }\r\n        );\r\n      },\r\n    },\r\n  ],\r\n});\r\n\r\nonMounted(() => {\r\n  getPageData();\r\n});\r\n\r\nconst getPageData = () => {\r\n  dListp().then((res) => {\r\n    treeObj.data = res.data.list;\r\n    if (res.data.list.length) getDictPageData(res.data.list[0].id);\r\n  });\r\n};\r\n\r\nconst getDictPageData = (id) => {\r\n  table.loading = true;\r\n  const params = {\r\n    pid: id,\r\n    page: pageProps.page,\r\n    pageSize: pageProps.pageSize,\r\n  };\r\n  dListz(params).then((res) => {\r\n    table.data = res.data.list.data;\r\n    pageProps.total = res.data.list.total;\r\n    table.loading = false;\r\n  });\r\n};\r\n// add dict\r\nconst handleAddDictp = () => {\r\n  modal.visible = true;\r\n  modal.title = \"添加字典\";\r\n  modal.form = {\r\n    pid: 0,\r\n    name: \"\",\r\n    value: \"\",\r\n    sort: 100,\r\n    description: \"\",\r\n  };\r\n};\r\n// edit dict\r\nconst editDictpRow = () => {\r\n  modal.title = \"编辑字典\";\r\n  modal.visible = true;\r\n  modal.form = Object.assign({}, treeObj.option);\r\n};\r\n// delete dict\r\nconst deleteDictpRow = () => {\r\n  if (treeObj.option.id) {\r\n    deleteRow(treeObj.option);\r\n  } else {\r\n    $message.success(\"没有选择数据！\");\r\n  }\r\n};\r\n// delete\r\nconst deleteId = (row) => {\r\n  dDelete({ id: row.id }).then((res) => {\r\n    $message.success(res.message);\r\n    getPageData();\r\n  });\r\n};\r\n// data delete\r\nconst deleteRow = (row) => {\r\n  $dialog.confirm({\r\n    title: \"删除警告\",\r\n    content: \"你确定要删除此字典吗？\",\r\n    confirm() {\r\n      deleteId(row);\r\n    },\r\n    cancel() {\r\n      $message.success(\"取消删除！\");\r\n    },\r\n  });\r\n};\r\nconst getSelectedKeys = (keys, option) => {\r\n  treeObj.option = option[0];\r\n  getDictPageData(option[0].id);\r\n};\r\nconst formRefs = ref(null);\r\nconst saveFormData = () => {\r\n  formRefs.value?.validate(async (errors) => {\r\n    if (!errors) {\r\n      console.log(\"suc\");\r\n      const res = modal.form.id\r\n        ? await dEdit(modal.form)\r\n        : await dAdd(modal.form);\r\n      if (res.code === 200) (modal.visible = false), getPageData();\r\n      $message.success(res.message);\r\n    } else {\r\n      console.log(errors);\r\n    }\r\n  });\r\n};\r\nconst addFormData = () => {\r\n  if (treeObj.option.id) {\r\n    modal.visible = true;\r\n    modal.title = \"添加字典项\";\r\n    modal.form = {\r\n      pid: treeObj.option.id,\r\n      name: \"\",\r\n      value: \"\",\r\n      sort: 100,\r\n      description: \"\",\r\n    };\r\n  } else {\r\n    $message.warning(\"选择左侧字典！\");\r\n  }\r\n};\r\n// 分页\r\nconst UpdatePageChange = (a) => {\r\n  pageProps.page = a.page;\r\n  pageProps.pageSize = a.pageSize;\r\n  const id = treeObj.option?.id ? treeObj.option.id : treeObj.data[0].id;\r\n  getDictPageData(id);\r\n};\r\nconst editRow = (row) => {\r\n  modal.title = \"编辑字典项\";\r\n  modal.visible = true;\r\n  modal.form = Object.assign({}, row);\r\n};\r\n</script>"],"names":["dListp","params","request","dListz","dAdd","data","dEdit","dDelete","treeObj","reactive","pageProps","modal","table","row","permission","resolveDirective","h","NSpace","withDirectives","NButton","editRow","deleteRow","onMounted","getPageData","res","getDictPageData","id","handleAddDictp","editDictpRow","deleteDictpRow","deleteId","getSelectedKeys","keys","option","formRefs","ref","saveFormData","_a","errors","__async","addFormData","UpdatePageChange"],"mappings":"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"}