var D=(s,v,i)=>new Promise((u,f)=>{var t=m=>{try{d(i.next(m))}catch(g){f(g)}},U=m=>{try{d(i.throw(m))}catch(g){f(g)}},d=m=>m.done?u(m.value):Promise.resolve(m.value).then(t,U);d((i=i.apply(s,v)).next())});import{n as k,o as Q,r as N,h,a as r,b as W,c as X,d as w,e as n,w as o,j as O,y as c,N as Y,z as P,q as Z,x as C,A as R,B as ee}from"./0ae629d1.js";import{m as te}from"./5674fa41.js";function ae(s){return k({url:"/admin/nav.links/Favicon",method:"get",params:s})}function ne(s){return k({url:"/admin/nav.links/list",method:"get",params:s})}function le(s){return k({url:"/admin/nav.links/add",method:"post",data:s})}function oe(s){return k({url:"/admin/nav.links/edit",method:"PUT",data:s})}function se(s){return k({url:"/admin/nav.links/del",method:"delete",params:s})}const ie={class:"page-contanier"},re={ref:"pageHeader",class:"page-header"},de={class:"page-content"},ue={class:"flex"},me={class:"flex"},ve={__name:"navlinks",setup(s){Q(()=>{d(),$()});const v=N([]),i=h({value:"",menu:""}),u=h({page:1,pageSize:10,total:0}),f=h({data:[],loading:!1}),t=h({title:"添加链接",visible:!1,form:{name:"",icon:"",description:"",link:"",state:1,sort:100,views:1e3,likes:1e3,menu_id:1},rules:{name:[{required:!0,message:"请输入名称！",trigger:["input","blur"]}]}}),U=[{type:"selection",fixed:"left"},{title:"名称",key:"name"},{title:"描述",key:"description",ellipsis:!0},{title:"排序",key:"sort",resizable:!0},{title:"图标",key:"icon",render(a){return c(Y,{width:"40",src:a.icon},{})}},{title:"显示",key:"state",render(a){return a.state==0?c(P,{type:"error"},{default:()=>"否"}):c(P,{type:"info"},{default:()=>"是"})}},{title:"浏览量",key:"views"},{title:"收藏量",key:"likes"},{title:"添加时间",key:"create_time"},{title:"操作",key:"actions",width:"150",fixed:"right",render(a){const e=Z("permission");return c(ee,{},{default:()=>[C(c(R,{size:"small",type:"primary",onClick:()=>A(a)},{default:()=>"编辑"}),[[e,{action:"nlinks:edit"}]]),C(c(R,{size:"small",type:"error",onClick:()=>T(a)},{default:()=>"删除"}),[[e,{action:"nlinks:delete"}]])]})}}],d=()=>{f.loading=!0;const a={keyword:i.value,menu:i.menu,page:u.page,pageSize:u.pageSize};ne(a).then(e=>{f.data=e.data.list.data,u.total=e.data.list.total,f.loading=!1})},m=()=>{u.page=1,d()},g=()=>{u.page=1,i.menu="",d()},$=()=>{te().then(a=>{v.value=a.data.list})},B=()=>{ae({url:t.form.link}).then(a=>{const e=a.data;t.form.name=e.title,t.form.icon=e.ico_url,t.form.description=e.description})},F=a=>{u.page=a.page,u.pageSize=a.pageSize,d()},q=()=>{t.title="添加链接",t.visible=!0,t.form={name:"",icon:"",description:"",link:"",state:1,sort:100,views:1e3,likes:1e3,menu_id:1}},I=(a,e)=>{var _;(_=a.value)==null||_.validate(b=>{b?console.log(b):(console.log("suc"),e&&e())})},z=N(null),L=()=>{I(z,V())},V=()=>D(this,null,function*(){const a=t.form.id?yield oe(t.form):yield le(t.form);a.code===200&&(t.visible=!1,d()),$message.success(a.message)}),A=a=>{t.title="修改链接",t.visible=!0,t.form=Object.assign({},a)},E=a=>{se({id:a.id}).then(e=>{$message.success(e.message),d()})},T=a=>{$dialog.confirm({title:"删除警告",content:"你确定要删除此链接吗？",confirm(){E(a)},cancel(){$message.success("取消删除！")}})};return(a,e)=>{const _=r("n-tree-select"),b=r("page-search"),j=r("page-table"),y=r("n-input"),p=r("n-form-item"),M=r("LogoIonic"),H=r("n-icon"),S=r("n-radio-button"),G=r("n-radio-group"),x=r("n-input-number"),J=r("n-form"),K=r("page-model");return W(),X("div",ie,[w("div",re,[n(b,{value:i.value,"onUpdate:value":e[1]||(e[1]=l=>i.value=l),onOnSearch:e[2]||(e[2]=l=>m()),onOnReset:g},{default:o(()=>[n(_,{class:"w-xs mr-5",value:i.menu,"onUpdate:value":e[0]||(e[0]=l=>i.menu=l),placeholder:"选择菜单",options:v.value,"label-field":"name","key-field":"id"},null,8,["value","options"])]),_:1},8,["value"])],512),w("div",de,[n(j,{data:f.data,columns:U,loading:f.loading,onOnAdd:q,onOnRefresh:e[3]||(e[3]=l=>d()),pagination:!0,pageProps:u,onOnUpdatePage:F,permission:{action:"nlinks:add"}},null,8,["data","loading","pageProps"])]),n(K,{visible:t.visible,"onUpdate:visible":e[13]||(e[13]=l=>t.visible=l),title:t.title,onOnSave:L},{default:o(()=>[n(J,{ref_key:"formRefs",ref:z,"label-placement":"left","label-width":80,model:t.form,rules:t.rules,"show-require-mark":!0},{default:o(()=>[n(p,{label:"名称",path:"name"},{default:o(()=>[n(y,{value:t.form.name,"onUpdate:value":e[4]||(e[4]=l=>t.form.name=l),placeholder:"输入名称"},null,8,["value"])]),_:1}),n(p,{label:"图标",path:"icon"},{default:o(()=>[n(y,{value:t.form.icon,"onUpdate:value":e[5]||(e[5]=l=>t.form.icon=l),placeholder:"输入链接图标"},null,8,["value"])]),_:1}),n(p,{label:"描述",path:"description"},{default:o(()=>[n(y,{value:t.form.description,"onUpdate:value":e[6]||(e[6]=l=>t.form.description=l),type:"textarea",placeholder:"请输入描述"},null,8,["value"])]),_:1}),n(p,{label:"链接",path:"link"},{default:o(()=>[n(y,{value:t.form.link,"onUpdate:value":e[7]||(e[7]=l=>t.form.link=l),placeholder:"输入链接地址"},null,8,["value"]),n(H,{size:"30",class:"cursor-pointer m-l-5",color:"#2d8cf0",onClick:B},{default:o(()=>[n(M)]),_:1})]),_:1}),w("div",ue,[n(p,{label:"显示",path:"state"},{default:o(()=>[n(G,{value:t.form.state,"onUpdate:value":e[8]||(e[8]=l=>t.form.state=l),name:"left-size"},{default:o(()=>[n(S,{value:0},{default:o(()=>[O("否")]),_:1}),n(S,{value:1},{default:o(()=>[O("是")]),_:1})]),_:1},8,["value"])]),_:1}),n(p,{label:"排序",path:"sort"},{default:o(()=>[n(x,{value:t.form.sort,"onUpdate:value":e[9]||(e[9]=l=>t.form.sort=l)},null,8,["value"])]),_:1})]),w("div",me,[n(p,{label:"浏览量",path:"views"},{default:o(()=>[n(x,{value:t.form.views,"onUpdate:value":e[10]||(e[10]=l=>t.form.views=l)},null,8,["value"])]),_:1}),n(p,{label:"收藏量",path:"likes"},{default:o(()=>[n(x,{value:t.form.likes,"onUpdate:value":e[11]||(e[11]=l=>t.form.likes=l)},null,8,["value"])]),_:1})]),n(p,{label:"选择菜单",path:"menu_id"},{default:o(()=>[n(_,{multiple:"","virtual-scroll":!1,options:v.value,"default-value":t.form.menu_id,"label-field":"name","key-field":"id","onUpdate:value":e[12]||(e[12]=l=>{t.form.menu_id=l})},null,8,["options","default-value"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["visible","title"])])}}};export{ve as default};
//# sourceMappingURL=9413906d.js.map
